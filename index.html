<!doctype html>
<html>
    <head>
        <!-- Change this if you want to allow scaling -->
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes"> 
        <meta http-equiv="Content-type" content="text/html; charset=utf-8">
	<link rel="stylesheet" href="assets/css/master.css" type="text/css" media="screen" />
	<title>My Time Tracker Pro</title>
	<script src="phonegap.js" type="text/javascript" charset="utf-8" ></script>
	<!--script src="assets/js/sim/phonegap-1.1.0.js" type="text/javascript" charset="utf-8" ></script-->
	<!--script src="childbrowser.js" type="text/javascript" charset="utf-8"></script-->
	<script src="assets/js/xui.js" type="text/javascript" charset="utf-8"></script>
	<script src="assets/js/dsl.js" type="text/javascript" charset="utf-8"></script>
	<script src="assets/js/app.js" type="text/javascript" charset="utf-8"></script>
	<script type="text/javascript" charset="utf-8">
		
	var state = 'ready';	

	function onLocationChange(func, time) {
	if(!time) time = 500;
	var currLoc = '';
	var currSrc = '';
	
	setInterval(function() {
		if(document.getElementById("frame1").contentDocument.location.href  != currLoc || document.getElementById("frame1").src != currSrc)
		{
		    currLoc = document.getElementById("frame1").contentDocument.location.href ;
		    currSrc = document.getElementById("frame1").src;
		    func(); //execute function
		} else {
			var id = setInterval(function() {ready(); clearInterval(id );},250);
		}
		}, time);
	}
 
	function openExternal(url)
	{
		busy();
		x$( "#frame1" ).attr('src', url);
		x$( "#main" ).before( "<a id='linkhandler'  target='frame1'>" );
		var link = x$('#linkhandler')[0];
		link.href = url;
		//link.setAttribute('target', '_self')
		
		var clickevent = document.createEvent("UIEvents"); 
		clickevent.initEvent('click', true, true); 
		link.dispatchEvent(clickevent);
		onLocationChange(busy,10);
	}

	function busy() {
		state = 'busy';	
		x$('#wait').css({ display : 'block' });
	}
	function ready() {
		state = 'ready';	
		x$('#wait').css({ display : 'none' });
	}


	</script>
    </head>
    <body>
 		<div id="title_bar">My Time Tracker Pro</div>
		<div id="main" class="view">
			<iframe onload="ready()"  class="frame" id="frame1" name="frame1" frameborder="1" marginheight="0" marginwidth="0" width="100%" height="100%" scrolling="auto"></iframe>
		</div>
		<div class="waitBox rounded-corners" id="wait">Please wait..</div>
<script>	
		//openExternal('http://myttpro.com',{ showLocationBar: false, showNavigationBar: false, showAddress: false});
		</script>
	</body>
</html>